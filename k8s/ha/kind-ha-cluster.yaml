kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
networking:
  apiServerAddress: "127.0.0.1"
  apiServerPort: 6444
  podSubnet: "10.244.0.0/16"
  serviceSubnet: "10.96.0.0/12"

nodes:
  # Control-plane
  - role: control-plane
    labels:
      topology: control-plane
    extraMounts:
      - hostPath: ../../data/control-plane
        containerPath: /data
      - hostPath: /var/run/docker.sock
        containerPath: /var/run/docker.sock
    extraPortMappings:
      - containerPort: 30080
        hostPort: 30080
      - containerPort: 30443
        hostPort: 30443
      - containerPort: 30808
        hostPort: 30808
      - containerPort: 30809
        hostPort: 30809
      - containerPort: 30090
        hostPort: 30090
      - containerPort: 30091
        hostPort: 30091
      - containerPort: 30092
        hostPort: 30092
      - containerPort: 30093
        hostPort: 30093
      - containerPort: 30094
        hostPort: 30094

  # Worker 1 - ML Training
  - role: worker
    labels:
      workload-type: ml-training
      node-tier: compute-intensive
    extraMounts:
      - hostPath: ../../data/ml-training
        containerPath: /data/training
      - hostPath: ../../models
        containerPath: /models
      - hostPath: /var/run/docker.sock
        containerPath: /var/run/docker.sock

  # Worker 2 - API Services
  - role: worker
    labels:
      workload-type: api-services
      node-tier: web-tier
    extraMounts:
      - hostPath: /var/run/docker.sock
        containerPath: /var/run/docker.sock

  # Worker 3 - Data Processing
  - role: worker
    labels:
      workload-type: data-processing
      node-tier: stateful
    extraMounts:
      - hostPath: ../../data/mongodb
        containerPath: /data/db
      - hostPath: ../../data/redis
        containerPath: /data/redis
      - hostPath: /var/run/docker.sock
        containerPath: /var/run/docker.sock